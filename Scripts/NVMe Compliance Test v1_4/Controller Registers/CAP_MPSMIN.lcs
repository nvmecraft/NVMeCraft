/// <summary>
/// To validate the MPSMIN field of the Controller Capabilities (CAP) register of an NVMe Controller.
/// </summary>
/// <Test Procedure>
/// 1. Configure the NVMe Host to read the CAP.MPSMIN register field (bits 51:48) of the NVMe Controller.
/// </Test Procedure>
/// <Observable Results>
/// 1. Verify that the value of the CAP.MPSMAX register field is greater than or equal to the value of the
/// CAP.MPSMIN register field.
/// </Observable Results>
    
NVMeDevice dev;
Serilog.Core.Logger log;

public int ScriptMain(int a, int b)
{
    dev = FromEngine.dev;
    log = FromEngine.log;
    
    log.Information("CAP.MPSMIN - CHECK");
    
    UInt64 MPSMIN = dev.controllerRegs.CAP.MPSMIN;
    
    log.Information("CAP.MPSMIN - 0x{0:X2}, The minimum memory page size is {1}.", MPSMIN, Math.Pow(2, (12 + MPSMIN)));
    
    PassOrFail(MPSMIN);
   
    return 0;
}

public void PassOrFail(UInt64 mpsmin)
{
    UInt64 MPSMAX = dev.controllerRegs.CAP.MPSMAX;
    
    if(MPSMAX >= mpsmin)
        log.Information("CAP.MPSMIN - PASS");
    else
        log.Information("CAP.MPSMIN - FAIL");
        
}